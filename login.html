<!DOCTYPE html>
<html>
  <head>
    <title>Log In page</title>
    <style>
      body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-image: url('gg.jpeg'); 
    background-size: cover;
    background-position: center; /* Center the background image */
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    justify-content: center; /* Center the signup and login divs */
    align-items: center;
}
      #login{
        background-color: rgba(255, 255, 255, 0.8); /* Adjust the last value for transparency */
        max-width: 400px;
        border-radius: 20px;
        padding: 50px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
            text-align: center;
            color: #333;
        }

        fieldset {
            border: none;
            margin: 0;
            padding: 0;
        }

        label {
            font-weight: bold;
            color: #555;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 6px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus {
            border-color: #007bff;
        }

        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }
        #forgot{
          display: none;
        }
        #forgot_otp{
          display: none;
        }
    </style>
  </head>
  <body>
    <div id="login">
      <fieldset>
        <section id="log_details">
        <legend><h1>Login</h1></legend>
        <label for="email">Emial :</label>
        <input type="email" id="log_email" name="email"><br><br>
        <label for="password">Password :</label>
        <input type="password" id="log_pass" name="password"><br><br>
        <button type="submit" id="log_butt" onclick="check_user()">Submit</button><br><br>
        <button type="submit" onclick="forgot_pass()">Forgot password</button><br><br>
      </section>
        <section id="forgot">
        <label for="forgot_email">Regestered Email :</label>
        <input type="email" id="forgot_email" name="email"><br><br>
        <label for="otp">OTP :</label>
        <input type="text" id="forgot_otp" name="otp"><br><br>
        <button type="submit" id="forgot_submit" onclick="forgototp_verify()">Submit</button>
      </section>
      </fieldset>
    </div>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.4.0/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>
    <script>
      (function() {
  emailjs.init("h4wXAc9gWRfMAqZrr"); // Replace with your user ID
})();
      const firebaseConfig = {
  apiKey: "AIzaSyDOs3Bo5KiBbx4lKaKWPcfhzJ7zju3bj6Y",
  authDomain: "done-fbbab.firebaseapp.com",
  databaseURL: "https://done-fbbab-default-rtdb.firebaseio.com",
  projectId: "done-fbbab",
  storageBucket: "done-fbbab.appspot.com",
  messagingSenderId: "35488698339",
  appId: "1:35488698339:web:d9b7b05dfed52c2cf19ad6",
  measurementId: "G-M8Q9CH451K"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
var data = firebase.database();

// var database = firebase.database();

var dataArray = [];

var ref = data.ref("Login_Details"+"/");
ref.once("value", function(snapshot) {
  snapshot.forEach(function(childSnapshot) {
    var childData = childSnapshot.val();
    dataArray.push(childData);
  });
  console.log(dataArray); // This will log your array
});
function check_user() {
    var email = document.getElementById("log_email").value;
    var password = document.getElementById("log_pass").value;

    var found = false;

    for (var i = 0; i < dataArray.length; i++) {
        if (dataArray[i].Email === email && dataArray[i].Password === password) {
            found = true;
            break;
        }
    }

    if (found) {
        // User found, you can redirect or perform any action here
        Swal.fire({
          title: "Successfully LogIn Completed....",
          text: "............",
          icon: "success"
        });
    } else {
        // User not found, show an error message or perform any action here
        Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "OTP isn't matched....",
      });
    }
}
function forgot_pass(){
  document.getElementById("log_details").style.display="none";
  document.getElementById("forgot").style.display="block";
  
}
//generate otp
const otp = Math.floor(Math.random()*10000);
function sendotp(){
// Prepare the email parameters
var templateParams = {
  to_name: document.getElementById("forgot_email").value,
  from_name: 'Ramireddy Manikantareddy',
  message: `Your OTP is: ${otp}`
};
var eID = "service_cnbymrb";
var tID = "template_da5n8oq";
// Send the email
emailjs.send(eID,tID , templateParams)
  .then( res => {
    Swal.fire({
      title: "OTP Sent to "+document.getElementById("forgot_email").value,
      text: "............",
      icon: "success"
    });
    return;
  })
  .catch();
}

function forgototp_verify(){
  if(document.getElementById("forgot_email").value==""){
    Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Enetr your Registered email...",
      });
      return;
  }
  sendotp();
  document.getElementById("forgot_otp").style.display="block";
  const forgot_otp = document.getElementById("forgot_otp").value;
  if(otp==forgot_otp){
    Swal.fire({
      title: "OTP verified Successfully",
      text: "............",
      icon: "success"
    });
  }
  else{
    Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Entered OTP is Wrong...",
      });
      return;
  }
  
}


    </script>
  </body>
</html>